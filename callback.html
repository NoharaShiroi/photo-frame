<!DOCTYPE html>
<html>
<head>
    <title>Callback</title>
    <script>
        function handleAuthCallback() {
            const hash = window.location.hash.substring(1);
            const params = new URLSearchParams(hash);
            const accessToken = params.get('access_token');

            if (accessToken) {
                // 回傳 token 給父視窗（原頁面）
                if (window.opener) {
                    window.opener.postMessage({
                        type: 'oauth-callback',
                        accessToken: accessToken
                    }, '*');
                }
                // 關閉此視窗（僅限彈出視窗模式）
                window.close();
            } else {
                console.error('未取得 access_token');
            }
        }
        window.addEventListener('load', handleAuthCallback);
    </script>
</head>
<body>
    <p>處理登入中，請稍候...</p>
</body>
</html>
